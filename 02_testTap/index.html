<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>Tap Move Circle</title>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            background: #111;
            color: #fff;
            touch-action: none; /* Disable default gestures to capture taps cleanly */
            -webkit-user-select: none;
            -ms-user-select: none;
            user-select: none;
            overscroll-behavior: none;
        }
        /* Fill the whole safe viewport, including under notches */
        .wrap {
            position: fixed;
            inset: 0;
            height: 100svh; /* Use small viewport to avoid toolbar jumps */
            width: 100vw;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #111;
        }
        canvas {
            display: block;
            max-width: 100%;
            max-height: 100%;
        }
        /* Hint portrait usage (cannot hard-lock without app manifest) */
        @media (orientation: landscape) {
            .landscape-hint {
                position: fixed;
                inset: 0;
                display: flex;
                align-items: center;
                justify-content: center;
                background: rgba(0,0,0,0.7);
                color: #fff;
                font: 600 16px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Hiragino Kaku Gothic ProN", "Noto Sans JP", "Yu Gothic UI", sans-serif;
                z-index: 2;
            }
        }
        @media (orientation: portrait) {
            .landscape-hint { display: none; }
        }
    </style>
</head>
<body>
    <div class="wrap">
        <canvas id="stage"></canvas>
    </div>

    <script>
    (function() {
        const canvas = document.getElementById('stage');
        const ctx = canvas.getContext('2d');

        const state = {
            circleX: 0,
            circleY: 0,
            circleRadiusCssPx: 24, // radius in CSS pixels
            initialized: false
        };

        function resizeCanvas() {
            const dpr = Math.max(1, Math.min(3, window.devicePixelRatio || 1));
            const cssWidth = window.innerWidth;
            const cssHeight = Math.max(window.innerHeight, document.documentElement.clientHeight);

            canvas.style.width = cssWidth + 'px';
            canvas.style.height = cssHeight + 'px';
            canvas.width = Math.floor(cssWidth * dpr);
            canvas.height = Math.floor(cssHeight * dpr);
            ctx.setTransform(dpr, 0, 0, dpr, 0, 0); // scale drawing to CSS pixels

            if (!state.initialized) {
                state.circleX = cssWidth / 2;
                state.circleY = cssHeight / 2;
                state.initialized = true;
            }
            draw();
        }

        function draw() {
            const w = canvas.clientWidth;
            const h = canvas.clientHeight;
            ctx.clearRect(0, 0, w, h);

            // background
            ctx.fillStyle = '#111';
            ctx.fillRect(0, 0, w, h);

            // circle
            ctx.beginPath();
            ctx.arc(state.circleX, state.circleY, state.circleRadiusCssPx, 0, Math.PI * 2);
            ctx.fillStyle = '#0bd';
            ctx.fill();

            // subtle center dot
            ctx.beginPath();
            ctx.arc(state.circleX, state.circleY, 2, 0, Math.PI * 2);
            ctx.fillStyle = '#fff';
            ctx.fill();
        }

        function getEventPosition(e) {
            if (e.touches && e.touches[0]) {
                return { x: e.touches[0].clientX, y: e.touches[0].clientY };
            }
            if (e.changedTouches && e.changedTouches[0]) {
                return { x: e.changedTouches[0].clientX, y: e.changedTouches[0].clientY };
            }
            if (e.clientX != null) {
                return { x: e.clientX, y: e.clientY };
            }
            return null;
        }

        function handleTap(e) {
            e.preventDefault();
            const pos = getEventPosition(e);
            if (!pos) return;
            state.circleX = pos.x;
            state.circleY = pos.y;
            draw();
        }

        // Pointer events first (covers mouse + touch on modern browsers)
        canvas.addEventListener('pointerdown', handleTap, { passive: false });
        // Fallbacks for older browsers
        canvas.addEventListener('touchstart', handleTap, { passive: false });
        canvas.addEventListener('mousedown', handleTap, { passive: false });

        window.addEventListener('resize', resizeCanvas);
        window.addEventListener('orientationchange', () => setTimeout(resizeCanvas, 100));

        // Kick off
        resizeCanvas();
    })();
    </script>
</body>
</html>


